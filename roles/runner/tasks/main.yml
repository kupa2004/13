- name: Update system
  apt: update_cache=yes

- name: install JDK 11
  apt:
    name: openjdk-11-jdk
    state: present
    
- name: download tomcat server packages
  get_url:
    url: http://mirrors.estointernet.in/apache/tomcat/tomcat-9/v9.0.44/bin/apache-tomcat-9.0.44.tar.gz
    dest: /usr/local

- name: extract tomcat packages
  become_method: sudo
  unarchive:
    src: /usr/local/apache-tomcat-9.0.44.tar.gz
    dest: /usr/local
    remote_src: yes

- name: start tomcat services
  become_method: sudo
  shell: nohup /usr/local/apache-tomcat-9.0.44/bin/startup.sh

- name: Copy boxfuse
  synchronize: src=/home/boxfuse-sample-java-war-hello/target/ dest=/opt/tomcat/webapps/
  delegate_to: "{{ ip_db }}"
